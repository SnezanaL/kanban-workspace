<div
  class="flex h-screen overflow-hidden bg-gray-50 dark:bg-dark-500 text-gray-900 dark:text-dark-100"
>
  <lib-kanban-sidebar
    [boards]="boards()"
    [selectedBoardName]="selectedBoardName()"
    (boardSelected)="onBoardSelected($event)"
    (createBoardClicked)="onCreateBoard()"
  ></lib-kanban-sidebar>

  <div class="flex-1 flex flex-col">
    @if (boardResource(); as board) {
    <lib-kanban-header
      [boardTitle]="board.name"
      (addTaskClicked)="onAddTask()"
      (editBoardClicked)="onEditBoard()"
      (deleteBoardClicked)="onDeleteBoard()"
    ></lib-kanban-header>
    } @else {
    <lib-kanban-header></lib-kanban-header>
    }

    <main class="flex-1 overflow-auto bg-[#F4F7FD] dark:bg-dark-500">
      @if (boardResource(); as board) {
      <lib-kanban-board
        [board]="board"
        (taskAction)="onTaskAction($event)"
        (addTaskToColumn)="onAddTask($event)"
        (addColumn)="onAddColumn()"
      ></lib-kanban-board>
      } @else {
      <div class="flex h-full items-center justify-center text-sm text-gray-500">
        Loading board...
      </div>
      }

      <router-outlet></router-outlet>
    </main>
  </div>
</div>

<!-- Modals -->
<lib-kanban-task-modal
  #taskModal
  [columns]="columnNames()"
  (taskSaved)="onTaskSaved($event)"
  (subtaskToggled)="onSubtaskToggled($event)"
></lib-kanban-task-modal>

<lib-kanban-board-modal #boardModal (boardSaved)="onBoardSaved($event)"></lib-kanban-board-modal>

<lib-kanban-confirm-dialog #confirmDialog (confirmed)="onConfirmed()"></lib-kanban-confirm-dialog>
